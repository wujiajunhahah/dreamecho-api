# DreamEcho iOS 应用部署指南

## 方法一：使用脚本自动创建 Xcode 项目（推荐）

我已经为你准备了一个自动化脚本，运行即可创建完整的 Xcode 项目：

```bash
cd /Users/wujiajun/dream_to_model_web/ios
./create_xcode_project.sh
```

脚本会自动：
1. 创建 DreamEcho.xcodeproj 项目文件
2. 配置所有必要的构建设置
3. 添加所有源文件和资源

## 方法二：手动在 Xcode 中创建（如果脚本失败）

### 第一步：创建新项目

1. 打开 Xcode（需要 Xcode 15 或更高版本）
2. 选择 **File > New > Project**
3. 选择 **iOS > App**
4. 配置项目：
   - Product Name: `DreamEcho`
   - Team: 选择你的 Apple Developer 账号
   - Organization Identifier: `com.yourname` （改成你的）
   - Bundle Identifier: `com.yourname.DreamEcho`
   - Interface: **SwiftUI**
   - Language: **Swift**
   - Storage: None
   - Include Tests: ✅
5. 保存位置选择：`/Users/wujiajun/dream_to_model_web/ios/`

### 第二步：导入源代码

1. 在 Xcode 中删除自动生成的 `ContentView.swift`
2. 在 Finder 中打开 `/Users/wujiajun/dream_to_model_web/ios/DreamEchoApp/Sources/`
3. 将整个 `Sources` 文件夹拖入 Xcode 项目
4. 选择：
   - ✅ Copy items if needed
   - ✅ Create groups
   - ✅ Add to targets: DreamEcho

### 第三步：配置项目设置

1. 点击项目根节点，选择 **TARGETS > DreamEcho**
2. **General** 标签页：
   - Minimum Deployments: **iOS 16.0**
   - Supported Destinations: ✅ iPhone, ✅ iPad
3. **Signing & Capabilities**：
   - Automatically manage signing: ✅
   - Team: 选择你的开发团队
4. **Info** 标签页添加：
   - 右键 > Add Row
   - Key: `API_BASE_URL`, Value: `https://api.dreamecho.ai`
   - Key: `ENABLE_HAPTICS`, Value: `true`

### 第四步：配置 Info.plist

用以下内容替换 `Info.plist`：

```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
    <key>CFBundleName</key>
    <string>DreamEcho</string>
    <key>CFBundleDisplayName</key>
    <string>梦境回声</string>
    <key>CFBundleShortVersionString</key>
    <string>1.0</string>
    <key>CFBundleVersion</key>
    <string>1</string>
    <key>API_BASE_URL</key>
    <string>https://api.dreamecho.ai</string>
    <key>ENABLE_HAPTICS</key>
    <string>true</string>
    <key>UIApplicationSceneManifest</key>
    <dict>
        <key>UIApplicationSupportsMultipleScenes</key>
        <true/>
    </dict>
    <key>UILaunchStoryboardName</key>
    <string>LaunchScreen</string>
</dict>
</plist>
```

## 第五步：连接设备并部署

### 5.1 准备你的 iPhone/iPad

1. 用数据线连接设备到 Mac
2. 在设备上：
   - 打开 **设置 > 隐私与安全性 > 开发者模式** 
   - 打开开发者模式（需要重启）
3. 重启后，在 Mac 上选择 **Window > Devices and Simulators**
4. 点击你的设备，如果提示 "Trust This Computer?"，选择 **信任**

### 5.2 在 Xcode 中运行

1. 在 Xcode 顶部工具栏，设备选择器中选择你的 iPhone/iPad
2. 点击 ▶️ **Run** 按钮（或按 Cmd+R）
3. 首次运行可能需要几分钟构建
4. 如果出现代码签名错误：
   - 在设备上打开 **设置 > 通用 > VPN与设备管理**
   - 点击你的开发者账号
   - 点击 **信任**

## 常见问题排查

### 问题 1：找不到开发团队
**解决方案：**
1. 打开 Xcode > Settings > Accounts
2. 点击 `+` 添加你的 Apple ID
3. 登录后会自动创建个人开发团队（免费）

### 问题 2："无法验证开发者"
**解决方案：**
- 在 iPhone/iPad 上：
  - 设置 > 通用 > VPN与设备管理
  - 点击你的 Apple ID
  - 点击"信任"

### 问题 3：编译错误 "Cannot find type 'Dream' in scope"
**解决方案：**
- 确保所有文件都已正确导入
- 检查 Build Phases > Compile Sources 包含所有 .swift 文件

### 问题 4：运行时崩溃
**解决方案：**
1. 检查 Console 输出（Xcode 底部）
2. 确认 API_BASE_URL 配置正确
3. 如果是网络错误，可能需要配置后端服务器

## 测试功能清单

部署成功后，测试以下功能：

- ✅ 应用启动显示主界面
- ✅ 导航栏切换（首页、梦境实验室、图书馆、个人）
- ✅ 液态玻璃效果正常显示
- ✅ 粒子背景动画流畅
- ✅ 触摸交互有触觉反馈（需真机）
- ✅ AR 预览功能（需添加 USDZ 模型文件）

## 下一步

- 添加 3D 模型文件（USDZ）到 Resources 文件夹
- 配置后端 API 地址（修改 Info.plist 中的 API_BASE_URL）
- 测试完整的创建梦境流程

## 需要帮助？

如果遇到问题，提供以下信息：
1. 错误截图或日志
2. Xcode 版本
3. iOS 设备型号和系统版本




